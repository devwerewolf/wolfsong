<!DOCTYPE html>
<html>
  <head>
    <style>
      body { font-family: system-ui; padding: 20px; background: #d1ecf1; }
      button { padding: 8px 16px; margin: 5px; cursor: pointer; }
    </style>
  </head>
  <body>
    <h2>Iframe 2</h2>
    <p>Count: <span id="count-display">0</span></p>
    <button id="increment-btn">+1</button>
    <button id="decrement-btn">-1</button>
    <button id="add-10-btn">+10</button>
    
    <script src="../lib/client-inline.js"></script>
    <script>
      // This simulates the app having "imported" the library
      
      // Initialize client - will receive initial state from parent
      const client = createChildClient([
        { key: 'count' }
      ], { debug: true });
      
      // Subscribe to count changes
      client.subscribeToAtom('count', (value) => {
        document.getElementById('count-display').textContent = value;
      });
      
      // Button handlers with delta updates
      document.getElementById('increment-btn').addEventListener('click', () => {
        const current = client.getAtomValue('count');
        client.updateAtom('count', current + 1);
      });
      
      document.getElementById('decrement-btn').addEventListener('click', () => {
        const current = client.getAtomValue('count');
        client.updateAtom('count', current - 1);
      });
      
      document.getElementById('add-10-btn').addEventListener('click', () => {
        const current = client.getAtomValue('count');
        client.updateAtom('count', current + 10);
      });
    </script>
  </body>
</html>
